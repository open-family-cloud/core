# デプロイパターンの選び方

## パターン一覧

| # | パターン | 実行場所 | 公開方法 | ディレクトリ |
|---|---------|---------|---------|------------|
| 1 | VPS + Docker Compose | VPS 1台 | Traefik (Let's Encrypt HTTP) | `platforms/vps-compose/` |
| 2 | VPS + Kubernetes | VPS k8s クラスタ | Ingress Controller | `platforms/vps-k8s/` |
| 3 | 自宅 + 固定IP | 自宅サーバー | Traefik (HTTP/DNS challenge) | `platforms/home-static-ip/` |
| 4 | 自宅 + WireGuard トンネル | 自宅 + VPS | VPS で TLS 終端 → WireGuard | `platforms/home-tunnel/` |

## どのパターンを選ぶべきか

### パターン1を選ぶ場合

- VPS を持っている（またはこれから借りる）
- Kubernetes の経験がない / 不要
- **最もシンプル**で推奨の構成

### パターン2を選ぶ場合

- Kubernetes の経験がある
- 将来的にマルチノードへスケールしたい
- Helm / Kustomize ベースの運用に慣れている

### パターン3を選ぶ場合

- 自宅に常時稼働サーバーがある
- 固定グローバル IP を取得済み
- VPS のコストを避けたい
- NAS にデータを保存したい

### パターン4を選ぶ場合

- 自宅にサーバーがあるが、固定 IP がない（動的 IP）
- CGNAT 配下にいる
- 安価な VPS（トンネル終端のみ）と自宅サーバーを組み合わせたい
- 大容量データは自宅の NAS に置きつつ、外部からアクセスしたい

## 比較表

| 項目 | パターン1 | パターン2 | パターン3 | パターン4 |
|-----|-----------|-----------|-----------|-----------|
| 初期コスト | VPS月額 | VPS月額 | 自宅サーバー | 自宅サーバー+安VPS |
| ランニングコスト | VPS+S3 | VPS+S3 | 電気代のみ | 電気代+安VPS |
| ストレージ容量 | S3依存 | S3依存 | NAS（大容量可） | NAS（大容量可） |
| セットアップ難易度 | ★☆☆ | ★★★ | ★★☆ | ★★★ |
| 固定IP必要 | VPSに付属 | VPSに付属 | **必要** | 不要 |
| 可用性 | VPS依存 | 高（k8s） | 自宅回線依存 | 自宅回線依存 |
